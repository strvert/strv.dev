<!doctype html>
<html data-n-head-ssr lang="ja" prefix="og: http://ogp.me/ns#" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22ja%22%7D,%22prefix%22:%7B%22ssr%22:%22og:%20http://ogp.me/ns#%22%7D%7D">
  <head>
    <title> - strv.dev</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" data-hid="description" name="description" content="すとんりばーのポートフォリオ 兼 技術ブログ 兼 遊び場"><meta data-n-head="ssr" data-hid="og:locale" property="og:locale" content="ja_jp"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="strv.dev"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="article"><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https://strv.dev"><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="strv.dev"><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="すとんりばーのポートフォリオ 兼 技術ブログ 兼 遊び場"><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="https://strv.dev/images/ogp/main.png"><meta data-n-head="ssr" name="twitter:card" content="summary_large_image"><meta data-n-head="ssr" name="twitter:creator" content="@strvert"><link data-n-head="ssr" data-hid="gf-prefetch" rel="dns-prefetch" href="https://fonts.gstatic.com/"><link data-n-head="ssr" data-hid="gf-preconnect" rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link data-n-head="ssr" data-hid="gf-preload" rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=M PLUS 1:wght@200;300;400;600&family=M PLUS Rounded 1c:wght@300;400;500&family=Source Code Pro:wght@300;400&family=Sawarabi Gothic:wght@400&display=swap"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="apple-touch-icon" type="image/png" href="/apple-touch-icon-180x180.png"><link data-n-head="ssr" rel="icon" type="image/png" href="/icon-192x192.png"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link data-n-head="ssr" rel="stylesheet" href="https://cdn.iconmonstr.com/1.3.0/css/iconmonstr-iconic-font.min.css"><script data-n-head="ssr" src="https://www.googletagmanager.com/gtag/js?id=G-7CSGM5KZ9W" async></script><script data-n-head="ssr" data-hid="gf-script">!function(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=M PLUS 1:wght@200;300;400;600&family=M PLUS Rounded 1c:wght@300;400;500&family=Source Code Pro:wght@300;400&family=Sawarabi Gothic:wght@400&display=swap",document.querySelector("head").appendChild(e)}()</script><noscript data-n-head="ssr" data-hid="gf-noscript"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=M PLUS 1:wght@200;300;400;600&family=M PLUS Rounded 1c:wght@300;400;500&family=Source Code Pro:wght@300;400&family=Sawarabi Gothic:wght@400&display=swap"></noscript><link rel="preload" href="/_nuxt/runtime.67a9642.js" as="script"><link rel="preload" href="/_nuxt/commons/app.4008772.js" as="script"><link rel="preload" href="/_nuxt/vendors/app.0c1ae1a.js" as="script"><link rel="preload" href="/_nuxt/app.94d2496.js" as="script"><link rel="preload" href="/_nuxt/pages/blog/_blogpost.0d669ab.js" as="script"><link rel="preload" href="/_nuxt/pages/about/index/pages/blog/_blogpost.6ec5ae4.js" as="script"><style data-vue-ssr-id="5f655f6e:0 e0c2e3f4:0 1e38ac46:0 30178fb4:0 0d0f8c20:0 ae212426:0 4f708215:0 a5cb01c6:0 03a0fda8:0 644b44be:0 601d28ce:0 32fc01cb:0 300fd634:0 f694ebf6:0 1e24ad00:0 10082e34:0 ae2e6ba8:0">*,:after,:before{box-sizing:border-box}:after,:before{text-decoration:inherit;vertical-align:inherit}html{cursor:default;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-break:break-word}body{margin:0}h1{font-size:2em;margin:.67em 0}dl dl,dl ol,dl ul,ol dl,ol ol,ol ul,ul dl,ul ol,ul ul{margin:0}hr{height:0;overflow:visible}main{display:block}nav ol,nav ul{list-style:none;padding:0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}audio,canvas,iframe,img,svg,video{vertical-align:middle}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}iframe,img{border-style:none}svg:not([fill]){fill:currentColor}svg:not(:root){overflow:hidden}table{border-collapse:collapse}button,input,select{margin:0}button{overflow:visible;text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}fieldset{border:1px solid #a0a0a0;padding:.35em .75em .625em}input{overflow:visible}legend{color:inherit;display:table;max-width:100%;white-space:normal}progress{display:inline-block;vertical-align:baseline}select{text-transform:none}textarea{margin:0;overflow:auto;resize:vertical}[type=checkbox],[type=radio]{padding:0}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}details,dialog{display:block}dialog{background-color:#fff;border:solid;color:#000;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;left:0;margin:auto;padding:1em;position:absolute;right:0;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}dialog:not([open]){display:none}summary{display:list-item}canvas{display:inline-block}template{display:none}[tabindex],a,area,button,input,label,select,summary,textarea{touch-action:manipulation}[hidden]{display:none}[aria-busy=true]{cursor:progress}[aria-controls]{cursor:pointer}[aria-disabled=true],[disabled]{cursor:not-allowed}[aria-hidden=false][hidden]{display:initial}[aria-hidden=false][hidden]:not(:focus){clip:rect(0,0,0,0);position:absolute}html{font-family:"M PLUS 1",-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif,"Segoe UI Emoji";font-size:15px;word-wrap:break-word;word-break:break-word;color:var(--strvdev-text-color);background-color:var(--strvdev-bg-color);block-size:100%;scroll-behavior:smooth}body{overflow-x:hidden}a{color:var(--strvdev-link-color);-webkit-text-decoration-line:none;text-decoration-line:none;text-decoration-thickness:.07em}a:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline;-webkit-text-decoration-style:dashed;text-decoration-style:dashed}.rounded-font{font-weight:500;font-family:"M PLUS Rounded 1c",sans-serif}::-webkit-scrollbar{background:#c9c9c9;inline-size:7.5px;block-size:7.5px}::-webkit-scrollbar-thumb{background:#808494;border-radius:5px}::-moz-selection{text-shadow:none;background:#a3c4fc}::selection{text-shadow:none;background:#a3c4fc}[v-cloak]{opacity:0}.page-enter-active,.page-leave-active{transition-property:opacity height block-size transform;transition-duration:.2s}.page-enter,.page-leave-to{opacity:0}.inverse-page-enter-active,.inverse-page-leave-active,.layout-enter-active,.layout-leave-active{transition-property:opacity height block-size transform;transition-duration:.2s}.layout-enter,.layout-leave-to{opacity:0}.inverse-layout-enter-active,.inverse-layout-leave-active{transition-property:opacity height block-size transform;transition-duration:.2s}.blogpost .nuxt-content{--header-height:44px}.blogpost .nuxt-content .headers-border,.blogpost .nuxt-content h1{border-bottom:2px solid;border-color:rgba(0,0,0,.13333333333333333)}.blogpost .nuxt-content .headers-margin,.blogpost .nuxt-content h1,.blogpost .nuxt-content h2,.blogpost .nuxt-content h3,.blogpost .nuxt-content h4,.blogpost .nuxt-content h5,.blogpost .nuxt-content h6{-webkit-padding-before:var(--header-height);padding-block-start:var(--header-height);-webkit-margin-before:calc(var(--header-height)*-1 + 1.7rem);margin-block-start:calc(var(--header-height)*-1 + 1.7rem)}.blogpost .nuxt-content h1{font-size:1.7rem}.blogpost .nuxt-content h1,.blogpost .nuxt-content h2,.blogpost .nuxt-content h3,.blogpost .nuxt-content h4,.blogpost .nuxt-content h5,.blogpost .nuxt-content h6{position:relative}.blogpost .nuxt-content h1:hover a:before,.blogpost .nuxt-content h2:hover a:before,.blogpost .nuxt-content h3:hover a:before,.blogpost .nuxt-content h4:hover a:before,.blogpost .nuxt-content h5:hover a:before,.blogpost .nuxt-content h6:hover a:before{content:"§";display:block;inline-size:2em;position:absolute;font-size:1em;left:-1em;bottom:.05em}.blogpost .nuxt-content .inline-code,.blogpost .nuxt-content li code,.blogpost .nuxt-content p code{font-family:var(--source-code-font);background-color:var(--strvdev-blogpost-code);border-radius:4px;margin:0 .2em;padding:0 .2em}.blogpost .nuxt-content p{font-size:1.08rem;letter-spacing:.03em;line-height:3ex}.blogpost .nuxt-content .panel-shadow,.blogpost .nuxt-content img,.blogpost .nuxt-content pre,.blogpost .nuxt-content table{box-shadow:5px 5px 7px 2px rgba(0,0,0,.0392156862745098)}.blogpost .nuxt-content pre{margin:0;border-radius:5px;border:2px solid rgba(0,0,0,.13333333333333333);-webkit-padding-before:2rem;padding-block-start:2rem;-webkit-padding-after:2rem;padding-block-end:2rem}.blogpost .nuxt-content pre code{font-family:var(--source-code-font)}.blogpost .nuxt-content .nuxt-content-highlight{position:relative}.blogpost .nuxt-content .filename{position:absolute;right:7px;transform:translateY(7px);font-size:.85rem;padding-left:5px;padding-right:4px;border-radius:4px;background-color:rgba(0,0,0,.0392156862745098);font-family:var(--source-code-font)}.blogpost .nuxt-content img{display:block;margin:0 auto;max-inline-size:100%;min-inline-size:70%;border-radius:4px}.blogpost .nuxt-content table{inline-size:100%}.blogpost .nuxt-content table thead{border-radius:40px;background-color:var(--strvdev-palette-4);color:hsla(0,0%,100%,.8509803921568627)}.blogpost .nuxt-content table tbody tr:nth-child(2n){background-color:#ccc}.blogpost .nuxt-content table tbody td{padding:.5em}.blogpost .nuxt-content .footnotes li{-webkit-padding-before:var(--header-height);padding-block-start:var(--header-height);-webkit-margin-before:calc(var(--header-height)*-1);margin-block-start:calc(var(--header-height)*-1)}:root{--source-code-font:"Source Code Pro";--strvdev-palette-1:#d9dbd9;--strvdev-palette-2:#7ac292;--strvdev-palette-3:#505464;--strvdev-palette-4:#273134;--strvdev-palette-5:#4174a5;--strvdev-palette-6:#a61010;--strvdev-blogpost-code:hsla(0,0%,100%,0.5647058823529412);--strvdev-blogpost-tag:#d1d3d1;--strvdev-bg-color:var(--strvdev-palette-1);--strvdev-text-color:var(--strvdev-palette-4);--strvdev-link-color:var(--strvdev-palette-5)}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.frame[data-v-5d1ecaf6]{display:flex;flex-direction:column;min-height:100vh}.frame .header[data-v-5d1ecaf6]{position:fixed;z-index:100;top:0;left:0}.frame main[data-v-5d1ecaf6]{flex:1}.frame main .content[data-v-5d1ecaf6]{max-inline-size:800px;margin:0 auto}@media screen and (max-width:800px){.frame main .content[data-v-5d1ecaf6]{margin-left:10px;margin-right:10px}}.header-main[data-v-031b1d0e]{background-color:var(--strvdev-palette-1);box-shadow:0 0 3px 0 var(--strvdev-palette-3);inline-size:100%;transition-property:transform;transition-duration:.3s;transform:translateY(calc(var(--header-row-height)*-1*var(--header-row-count)))}.header-main.open[data-v-031b1d0e]{transform:translateY(0)}.site-content-list[data-v-031b1d0e]{display:flex;justify-content:center}.header-grid[data-v-031b1d0e]{block-size:var(--header-row-height);max-inline-size:800px;margin:0 auto;position:relative;display:grid;grid-template-columns:repeat(5,1fr);grid-template-areas:"a b c d e";align-items:start;justify-items:center}.header-grid>.strvdevlogo[data-v-031b1d0e]{background-color:inherit;border-style:none;grid-area:c;padding-top:5px}.header-grid>.strvdevlogo[data-v-031b1d0e]:hover{cursor:pointer}.header-grid>.sitenav[data-v-031b1d0e]{grid-area:c}ul[data-v-30c9cc4b]{display:flex;list-style:none;padding:0;margin:0;justify-content:space-around}ul li[data-v-30c9cc4b]{text-align:center;font-size:1.1rem;font-weight:900;transition-property:color,background-color;transition-duration:.5s}ul li a[data-v-30c9cc4b]{display:block;inline-size:100%;block-size:100%;color:#333c49}svg[data-v-bddbf348]{display:block;margin:0 auto}.container-base[data-v-bdd67452]{-webkit-margin-before:80px;margin-block-start:80px}.giscus-wrapper[data-v-75e80776]{max-inline-size:820px;-webkit-padding-before:1rem;padding-block-start:1rem;margin:0 auto}@media screen and (max-width:820px){.giscus-wrapper[data-v-75e80776]{max-inline-size:800px}}.surround-menu[data-v-75e80776]{display:block;-webkit-margin-before:4rem;margin-block-start:4rem}.blogpost>header[data-v-75e80776]{-webkit-margin-after:1.26em;margin-block-end:1.26em}.blogpost>header>.post-title[data-v-75e80776]{font-size:2rem;-webkit-margin-after:.56em;margin-block-end:.56em}.blogpost>header>.post-info-wrapper[data-v-75e80776]{display:flex;justify-content:space-between;align-items:center}.blogpost>header>.post-info-wrapper>.publish-time[data-v-75e80776]{font-size:.95rem;color:rgba(0,0,0,.5333333333333333);margin:0}.list-wrapper[data-v-7e21c619]{display:flex;gap:.3em;align-items:flex-start}.list-wrapper>.material-icons[data-v-7e21c619]{color:inherit;font-size:1.3em}.list-wrapper>.tag-list[data-v-7e21c619]{display:flex;flex-wrap:wrap;list-style:none;margin:0;padding:0;gap:.7em}.list-wrapper>.tag-list li[data-v-7e21c619]{background-color:var(--strvdev-blogpost-tag);border-radius:4px;padding:0 .2em;font-size:.9em}.wrapper[data-v-08b63208]{display:grid;grid-auto-flow:column;justify-content:space-between;gap:.5rem;grid-template-columns:minmax(-webkit-max-content,auto) auto minmax(-webkit-max-content,auto);grid-template-columns:minmax(max-content,auto) auto minmax(max-content,auto);align-items:center}.wrapper .prev[data-v-08b63208]{justify-self:flex-start}.wrapper .seriesname[data-v-08b63208]{text-align:center}.wrapper .next[data-v-08b63208]{-webkit-margin-start:auto;margin-inline-start:auto;text-align:right}.button[data-v-08b63208]{display:block}.giscus-frame{width:100%}.footer-wrapper[data-v-30c6efbe]{box-shadow:0 0 3px 0 var(--strvdev-palette-3);-webkit-margin-before:5rem;margin-block-start:5rem;-webkit-padding-before:1.5rem;padding-block-start:1.5rem}.footer-wrapper .footer-main[data-v-30c6efbe]{position:relative;max-inline-size:800px;margin:0 auto;-webkit-padding-after:1rem;padding-block-end:1rem;color:rgba(0,0,0,.7333333333333333)}.footer-wrapper .footer-main .infos[data-v-30c6efbe]{display:flex;justify-content:space-between}.footer-wrapper .footer-main .infos .copyright[data-v-30c6efbe],.footer-wrapper .footer-main .infos .privacy[data-v-30c6efbe]{bottom:1em;left:0;font-size:.9rem;-webkit-margin-before:1em;margin-block-start:1em}.footer-wrapper .footer-main .im[data-v-30c6efbe]{font-size:1.5rem}.footer-wrapper .footer-main address[data-v-30c6efbe]{display:flex;flex-direction:row;flex-wrap:wrap;gap:.8rem;font-style:normal}.footer-wrapper .footer-main address p[data-v-30c6efbe]{display:flex;gap:.6rem;align-content:center;align-items:center;margin:0;font-size:.9rem}.footer-wrapper .footer-main .repository[data-v-30c6efbe]{-webkit-margin-before:.5rem;margin-block-start:.5rem}.footer-wrapper .footer-main .repository p[data-v-30c6efbe]{display:flex;gap:.6rem;align-content:center;align-items:center;margin:0}@media screen and (max-width:820px){.footer-wrapper .footer-main[data-v-30c6efbe]{padding-left:10px;padding-right:10px}}</style><link rel="preload" href="/_nuxt/static/1638050348/blog/cpp--write-an-nbit-adder-using-only-types/state.js" as="script"><link rel="preload" href="/_nuxt/static/1638050348/blog/cpp--write-an-nbit-adder-using-only-types/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1638050348/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="frame" data-v-5d1ecaf6><div class="header-main header" style="--header-row-height:44px;--header-row-count:1" data-v-031b1d0e data-v-5d1ecaf6><div class="site-content-list" data-v-031b1d0e><nav class="sitenav" data-v-031b1d0e><ul style="flex-direction:row" data-v-30c9cc4b data-v-031b1d0e><li style="line-height:44px;inline-size:200px" data-v-30c9cc4b><a href="/" class="nuxt-link-active" data-v-30c9cc4b>
      HOME
    </a></li><li style="line-height:44px;inline-size:200px" data-v-30c9cc4b><a href="/blog" class="nuxt-link-active" data-v-30c9cc4b>
      BLOG
    </a></li><li style="line-height:44px;inline-size:200px" data-v-30c9cc4b><a href="/about" data-v-30c9cc4b>
      ABOUT
    </a></li></ul></nav></div> <div class="header-grid" data-v-031b1d0e><button name="show-navcontent" aria-label="show navigation menu content" class="strvdevlogo" data-v-031b1d0e><div data-v-bddbf348 data-v-031b1d0e><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 35.893 6.419" width="184.37099999999998" height="33" style="isolation:isolate" data-v-bddbf348><defs data-v-bddbf348><clipPath id="_clipPath_wRGPbw1kW50q8FvcamYb3Hxr115iy0Iy" data-v-bddbf348><rect width="35.893" height="6.419" data-v-bddbf348></rect></clipPath></defs> <g clip-path="url(#_clipPath_wRGPbw1kW50q8FvcamYb3Hxr115iy0Iy)" data-v-bddbf348><clipPath id="_clipPath_I8fUhl3gs6z6fOmYoJZCtzdbffHu72Ll" data-v-bddbf348><rect x="0" y="0" width="35.893" height="6.419" transform="matrix(1,0,0,1,0,0)" fill="rgb(255,255,255)" data-v-bddbf348></rect></clipPath> <g clip-path="url(#_clipPath_I8fUhl3gs6z6fOmYoJZCtzdbffHu72Ll)" data-v-bddbf348><g class="characters" data-v-bddbf348><path d=" M 35.059 1.474 L 35.017 1.474 L 33.893 5.978 C 33.853 6.139 33.686 6.269 33.52 6.269 L 31.39 6.269 C 31.225 6.269 31.058 6.139 31.018 5.978 L 29.892 1.469 L 29.892 1.469 L 31.726 1.474 L 31.647 1.474 L 32.339 4.298 C 32.378 4.459 32.431 4.589 32.455 4.589 L 32.455 4.589 C 32.48 4.589 32.532 4.459 32.572 4.298 L 33.265 1.469 L 35.059 1.474 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 27.535 1.469 L 27.56 1.469 L 27.535 1.469 L 27.535 2.199 C 27.535 2.365 27.669 2.499 27.835 2.499 L 29.315 2.499 C 29.48 2.499 29.615 2.634 29.615 2.799 L 29.615 3.489 C 29.615 3.655 29.48 3.789 29.315 3.789 L 27.835 3.789 C 27.669 3.789 27.535 3.924 27.535 4.089 L 27.535 4.519 C 27.535 4.685 27.669 4.819 27.835 4.819 L 29.675 4.819 C 29.84 4.819 29.975 4.954 29.975 5.119 L 29.975 5.969 C 29.975 6.135 29.84 6.269 29.675 6.269 L 26.075 6.269 C 25.909 6.269 25.775 6.135 25.775 5.969 L 25.775 1.469 L 25.775 1.469 L 27.535 1.469 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 25.396 1.469 Q 25.414 1.537 25.43 1.609 L 25.43 1.609 L 25.43 1.609 Q 25.56 2.219 25.56 3.149 L 25.56 3.149 L 25.56 3.149 Q 25.56 4.069 25.43 4.679 L 25.43 4.679 L 25.43 4.679 Q 25.3 5.289 24.985 5.639 L 24.985 5.639 L 24.985 5.639 Q 24.67 5.989 24.12 6.129 L 24.12 6.129 L 24.12 6.129 Q 23.57 6.269 22.72 6.269 L 22.72 6.269 L 20.37 6.269 C 20.204 6.269 20.07 6.135 20.07 5.969 L 20.07 1.474 L 20.07 1.474 L 20.07 1.474 L 20.07 1.474 L 21.83 1.469 L 21.83 4.589 C 21.83 4.755 21.964 4.889 22.13 4.889 L 22.89 4.889 L 22.89 4.889 Q 23.33 4.889 23.5 4.744 L 23.5 4.744 L 23.5 4.744 Q 23.67 4.599 23.67 4.229 L 23.67 4.229 L 23.67 2.059 L 23.67 2.059 Q 23.67 1.689 23.5 1.544 L 23.5 1.544 L 23.5 1.544 Q 23.452 1.503 23.382 1.474 L 23.317 1.474 L 23.317 1.474 L 25.396 1.469 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 19.15 5.008 L 19.411 5.008 C 19.687 5.008 19.911 5.232 19.911 5.508 L 19.911 5.769 C 19.911 6.045 19.687 6.269 19.411 6.269 L 19.15 6.269 C 18.874 6.269 18.65 6.045 18.65 5.769 L 18.65 5.508 C 18.65 5.232 18.874 5.008 19.15 5.008 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 19.49 1.474 L 18.365 5.978 C 18.325 6.139 18.158 6.269 17.993 6.269 L 15.863 6.269 C 15.697 6.269 15.53 6.139 15.49 5.978 L 14.366 1.474 L 16.118 1.469 L 16.811 4.298 C 16.851 4.459 16.903 4.589 16.928 4.589 L 16.928 4.589 C 16.952 4.589 17.005 4.459 17.044 4.298 L 17.737 1.469 L 19.49 1.474 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 14.014 1.469 Q 14.082 1.826 14.096 2.276 L 14.096 2.276 L 14.096 2.276 Q 14.017 3.359 13.517 3.859 L 13.517 3.859 L 13.517 3.859 Q 13.396 3.981 13.376 3.994 C 13.24 4.088 13.194 4.281 13.273 4.426 L 14.143 6.006 C 14.223 6.151 14.153 6.269 13.987 6.269 L 12.677 6.269 C 12.512 6.269 12.32 6.148 12.249 5.998 L 11.602 4.63 C 11.531 4.481 11.339 4.359 11.173 4.359 L 11.037 4.359 C 10.872 4.359 10.737 4.494 10.737 4.659 L 10.737 5.969 C 10.737 6.135 10.603 6.269 10.437 6.269 L 9.277 6.269 C 9.112 6.269 8.977 6.135 8.976 5.969 L 8.946 1.469 L 10.737 1.469 L 10.737 2.769 C 10.737 2.935 10.872 3.069 11.037 3.069 L 11.707 3.069 L 11.707 3.069 Q 11.977 3.069 12.077 2.979 L 12.077 2.979 L 12.077 2.979 Q 12.177 2.889 12.177 2.649 L 12.177 2.649 L 12.177 1.889 L 12.177 1.889 Q 12.177 1.649 12.077 1.559 L 12.077 1.559 L 12.077 1.559 L 11.859 1.469 L 14.014 1.469 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 7.663 1.469 L 7.663 5.969 C 7.663 6.135 7.529 6.269 7.363 6.269 L 6.203 6.269 C 6.038 6.269 5.903 6.135 5.903 5.969 L 5.903 1.469 L 7.663 1.469 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 2.033 1.474 C 1.978 1.474 1.933 1.519 1.933 1.574 L 1.933 2.169 C 1.933 2.224 1.978 2.273 2.033 2.278 L 2.753 2.339 L 2.753 2.339 Q 3.553 2.409 4.048 2.639 L 4.048 2.639 L 4.048 2.639 Q 4.543 2.869 4.768 3.284 L 4.768 3.284 L 4.768 3.284 Q 4.993 3.699 4.993 4.349 L 4.993 4.349 L 4.993 4.349 Q 4.993 5.079 4.728 5.534 L 4.728 5.534 L 4.728 5.534 Q 4.463 5.989 3.898 6.204 L 3.898 6.204 L 3.898 6.204 Q 3.333 6.419 2.423 6.419 L 2.423 6.419 L 2.423 6.419 Q 1.753 6.419 1.138 6.339 L 1.138 6.339 L 1.138 6.339 L 0.247 6.151 C 0.085 6.117 -0.024 5.957 0.004 5.793 L 0.152 4.935 C 0.181 4.772 0.332 4.678 0.49 4.727 Q 0.693 4.789 1.203 4.864 L 1.203 4.864 L 1.203 4.864 Q 1.713 4.939 2.213 4.939 L 2.213 4.939 L 2.213 4.939 Q 2.473 4.939 2.673 4.929 L 2.673 4.929 L 2.673 4.929 L 2.805 4.914 C 2.97 4.895 3.103 4.745 3.103 4.579 L 3.103 4.319 C 3.103 4.154 2.97 4.007 2.805 3.993 L 2.193 3.939 L 2.193 3.939 Q 1.593 3.889 1.178 3.764 L 1.178 3.764 L 1.178 3.764 Q 0.763 3.639 0.513 3.414 L 0.513 3.414 L 0.513 3.414 Q 0.263 3.189 0.153 2.854 L 0.153 2.854 L 0.153 2.854 Q 0.043 2.519 0.043 2.039 L 0.043 2.039 L 0.043 2.039 Q 0.043 1.239 0.263 0.764 L 0.263 0.764 L 0.263 0.764 Q 0.521 0.163 1.036 0.019 L 1.036 0.019 L 1.036 0.019 L 1.036 0.019 L 1.036 1.469 L 1.728 1.469 L 2.033 1.474 L 2.033 1.474 Z " fill="rgb(51,60,73)" data-v-bddbf348></path></g> <g class="barcode" data-v-bddbf348><path d=" M 23.116 1.48 L 23.116 0 L 23.393 0 L 23.393 1.48 L 23.116 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 25.06 1.48 L 25.06 0 L 24.782 0 L 24.782 1.48 L 25.06 1.48 L 25.06 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 24.227 1.48 L 24.227 0 L 23.671 0 L 23.671 1.48 L 24.227 1.48 L 24.227 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 27.282 1.48 L 27.282 0 L 26.171 0 L 26.171 1.48 L 27.282 1.48 L 27.282 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 27.838 0 L 27.838 1.475 L 27.838 1.48 L 27.56 1.48 L 27.56 1.475 L 27.56 0 L 27.838 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 28.671 0 L 28.671 1.475 L 28.671 1.48 L 28.393 1.48 L 28.393 1.475 L 28.393 0 L 28.671 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 29.226 1.475 L 29.226 1.48 L 29.782 1.48 L 29.782 1.475 L 29.782 0 L 29.226 0 L 29.226 1.475 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 35.059 1.48 L 35.059 0 L 34.782 0 L 34.782 1.48 L 35.059 1.48 L 35.059 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 34.504 1.48 L 34.504 0 L 33.671 0 L 33.671 1.48 L 34.504 1.48 L 34.504 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 31.726 1.48 L 31.726 0 L 30.893 0 L 30.893 1.48 L 31.726 1.48 L 31.726 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 30.615 1.48 L 30.615 0 L 30.337 0 L 30.337 1.48 L 30.615 1.48 L 30.615 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 32.837 0 L 32.837 1.48 L 32.282 1.48 L 32.282 0 L 32.837 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 35.893 0.201 L 35.893 1.28 C 35.893 1.39 35.803 1.48 35.693 1.48 L 35.337 1.48 L 35.337 0 L 35.693 0 C 35.803 0 35.893 0.089 35.893 0.201 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 2.283 1.48 L 2.283 1.48 L 2.283 1.48 L 2.283 1.48 L 2.283 0 L 1.728 0 L 1.728 1.48 L 2.283 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 2.839 0 L 2.839 1.48 L 2.561 1.48 L 2.561 0 L 2.839 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 3.672 0 L 3.672 1.48 L 3.394 1.48 L 3.394 0 L 3.672 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 5.061 0 L 5.061 1.48 L 4.783 1.48 L 4.783 0 L 5.061 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 6.45 1.475 L 6.45 0 L 5.339 0 L 5.339 1.48 L 6.45 1.48 L 6.45 1.475 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 7.283 1.48 L 7.283 0.777 L 7.283 0 L 7.005 0 L 7.005 1.48 L 7.283 1.48 L 7.283 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 10.338 1.48 L 10.338 0 L 10.061 0 L 10.061 1.478 L 10.338 1.48 L 10.338 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 9.783 1.48 L 9.783 0 L 8.672 0 L 8.672 1.475 L 8.672 1.475 L 8.672 1.475 L 8.672 1.475 L 8.672 1.48 L 9.783 1.475 L 9.783 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 8.116 1.475 L 8.116 0 L 7.839 0 L 7.839 0.918 L 7.839 1.475 L 8.116 1.475 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 21.727 1.475 L 21.727 0 L 21.449 0 L 21.449 1.475 L 21.727 1.475 L 21.727 1.475 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 20.338 1.48 L 20.338 0 L 20.06 0 L 20.06 1.48 L 20.338 1.48 L 20.338 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 13.949 1.48 L 13.949 0 L 15.06 0 L 15.06 1.48 L 13.949 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 19.782 1.48 L 19.782 0 L 18.949 0 L 18.949 1.48 L 19.782 1.48 L 19.782 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 18.394 1.48 L 18.394 0 L 17.838 0 L 17.838 1.48 L 18.394 1.48 L 18.394 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 15.616 1.48 L 15.616 0 L 15.338 0 L 15.338 1.48 L 15.616 1.48 L 15.616 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 13.672 1.48 L 13.672 0 L 12.561 0 L 12.561 1.48 L 13.672 1.48 L 13.672 1.48 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 12.005 0 L 11.727 0 L 11.727 1.48 L 12.005 1.48 L 12.005 0 Z " fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 11.172 0 L 11.172 1.48 L 10.894 1.48 L 10.894 0 L 11.172 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 16.449 0 L 16.449 1.48 L 16.172 1.48 L 16.172 0 L 16.449 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 17.283 0 L 17.283 1.48 L 17.005 1.48 L 17.005 0 L 17.283 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path> <path d=" M 22.838 0 L 22.838 1.48 L 22.282 1.48 L 22.282 0 L 22.838 0 Z " fill-rule="evenodd" fill="rgb(51,60,73)" data-v-bddbf348></path></g></g></g></svg></div></button></div></div> <main data-v-5d1ecaf6><div class="content" data-v-5d1ecaf6><div class="container-base" data-v-bdd67452 data-v-5d1ecaf6><div data-fetch-key="blogpost-content:0"><div data-v-75e80776><article data-v-75e80776><div class="blogpost" data-v-75e80776><header data-v-75e80776><h1 class="post-title" data-v-75e80776>[C++]型だけでN bit加算器を書こう</h1> <div class="post-info-wrapper" data-v-75e80776><div class="tag-list" data-v-75e80776><div class="list-wrapper" data-v-7e21c619 data-v-75e80776><span class="material-icons" data-v-7e21c619>local_offer</span> <ul class="tag-list" data-v-7e21c619><li data-v-7e21c619><a href="/blog/search?t=C%2B%2B" data-v-7e21c619>C++</a></li><li data-v-7e21c619><a href="/blog/search?t=metaprogramming" data-v-7e21c619>metaprogramming</a></li><li data-v-7e21c619><a href="/blog/search?t=%E9%9D%99%E7%9A%84%E5%9E%8B%E4%BB%98%E3%81%91" data-v-7e21c619>静的型付け</a></li><li data-v-7e21c619><a href="/blog/search?t=concept" data-v-7e21c619>concept</a></li><li data-v-7e21c619><a href="/blog/search?t=C%2B%2B20" data-v-7e21c619>C++20</a></li></ul></div></div> <p class="publish-time" data-v-75e80776><time datetime="2021.06.17" data-v-75e80776>2021.06.17</time>に公開
          </p></div></header> <div class="nuxt-content" data-v-75e80776><p data-v-75e80776>最近、Twitterで以下の記事を見かけました。</p>
<p data-v-75e80776><a href="https://qiita.com/Kuniwak/items/983ba68fcf68d915b07d" rel="nofollow noopener noreferrer" target="_blank" data-v-75e80776>https://qiita.com/Kuniwak/items/983ba68fcf68d915b07d</a></p>
<p data-v-75e80776>2018年の記事と少し古めですが、TypeScriptの型システムを利用して論理ゲート～4bit加算器を実装しています。こんなものを見かけたら、C++でもやりたくなってしまうのが人間というものです。ということなので、今回はC++の型システムで組み合わせ回路を実装していきたいと思います。やりたかっただけです。</p>
<h1 id="レギュレーション" data-v-75e80776><a href="#%E3%83%AC%E3%82%AE%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>レギュレーション</h1>
<p data-v-75e80776>上記の記事では、TypeScriptの型システムを用いた静的計算を「コンパイル時計算」とし、TypeScriptのコンパイル時計算で組み合わせ回路を実装するという趣旨になっていました。しかし、C++でこの言葉をそのまま採用して実装すると、<code data-v-75e80776>constexpr</code>で世界のすべてを殴り倒すことが出来てしまい、面白くありません。せっかくなので今回は、以下のような条件のもとでコードを書いてみましょう。</p>
<ul data-v-75e80776>
<li data-v-75e80776>非型テンプレートパラメータ以外の場所では、定数値を含め値を書かない。</li>
<li data-v-75e80776>同様に、非型テンプレートパラメータを算出する以外の目的で<code data-v-75e80776>constexpr</code>な処理を利用しない。</li>
<li data-v-75e80776>実行時の処理については、上記の制約の対象としない。ただし、実行時にして良い処理は入出力に関するもののみとする。</li>
</ul>
<p data-v-75e80776>もはや型で遊びたいだけであり、何が目的の実装なのかよくわかりませんが(そもそもレギュレーションガバガバですが)、まあよいでしょう。</p>
<h1 id="検証環境" data-v-75e80776><a href="#%E6%A4%9C%E8%A8%BC%E7%92%B0%E5%A2%83" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>検証環境</h1>
<ul data-v-75e80776>
<li data-v-75e80776>clang version 12.0.0</li>
<li data-v-75e80776>x86_64-pc-linux-gnu</li>
<li data-v-75e80776>std=c++2a</li>
</ul>
<h1 id="注意点" data-v-75e80776><a href="#%E6%B3%A8%E6%84%8F%E7%82%B9" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>注意点</h1>
<p data-v-75e80776>本記事の実装では、fold expressionの展開数制限およびtemplateの再帰深度上限を回避するような実装は行っていません。ですので、Nを大きくしていくと意外とすぐ死にます。</p>
<h1 id="バイナリ型を定義する" data-v-75e80776><a href="#%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E5%9E%8B%E3%82%92%E5%AE%9A%E7%BE%A9%E3%81%99%E3%82%8B" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>バイナリ型を定義する</h1>
<p data-v-75e80776>先駆者様に倣って、0 or 1の保持にも型を利用していこうと思います。ここは複雑ではありませんので、全体のコードをいきなり提示します。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>binary.h</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>pragma</span> <span class="token expression" data-v-75e80776>once</span></span>
<span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>include</span> <span class="token string" data-v-75e80776>&lt;type_traits></span></span>

<span class="token keyword" data-v-75e80776>namespace</span> Binary <span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>Binary</span> <span class="token punctuation" data-v-75e80776>{</span><span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>I</span> <span class="token operator" data-v-75e80776>:</span> <span class="token base-clause" data-v-75e80776><span class="token keyword" data-v-75e80776>public</span> <span class="token class-name" data-v-75e80776>Binary</span></span> <span class="token punctuation" data-v-75e80776>{</span><span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>O</span> <span class="token operator" data-v-75e80776>:</span> <span class="token base-clause" data-v-75e80776><span class="token keyword" data-v-75e80776>public</span> <span class="token class-name" data-v-75e80776>Binary</span></span>  <span class="token punctuation" data-v-75e80776>{</span><span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>T</span><span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>concept</span> <span class="token class-name" data-v-75e80776>IsBinary</span> <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>is_base_of_v<span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token punctuation" data-v-75e80776>,</span> T<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>T</span><span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>concept</span> <span class="token class-name" data-v-75e80776>IsZero</span> <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>is_same_v<span class="token operator" data-v-75e80776>&lt;</span>T<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span> <span class="token operator" data-v-75e80776>&&</span> IsBinary<span class="token operator" data-v-75e80776>&lt;</span>T<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>T</span><span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>concept</span> <span class="token class-name" data-v-75e80776>IsOne</span> <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>is_same_v<span class="token operator" data-v-75e80776>&lt;</span>T<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span> <span class="token operator" data-v-75e80776>&&</span> IsBinary<span class="token operator" data-v-75e80776>&lt;</span>T<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>

</code></pre></div>
<p data-v-75e80776>マーカーの役割を果たす<code data-v-75e80776>Binary</code>型と、それを継承した<code data-v-75e80776>O</code>と<code data-v-75e80776>I</code>のバイナリ型を定義しました。今回はドントケアを含む回路は想定しませんので、回路で現れる値(型だけど)が0と1以外の値を取ることはありません。ですので、渡されてきた型がバイナリであるか、つまり<code data-v-75e80776>O</code>と<code data-v-75e80776>I</code>のどちらかであるかを判断するコンセプトを定義しています。また、対象の型が<code data-v-75e80776>O</code>であるか、<code data-v-75e80776>I</code>であるかを判断するための<code data-v-75e80776>IsZero</code>と<code data-v-75e80776>IsOne</code>のコンセプトも用意しました。</p>
<h2 id="最低限の出力処理を用意しておく" data-v-75e80776><a href="#%E6%9C%80%E4%BD%8E%E9%99%90%E3%81%AE%E5%87%BA%E5%8A%9B%E5%87%A6%E7%90%86%E3%82%92%E7%94%A8%E6%84%8F%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8F" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>最低限の出力処理を用意しておく</h2>
<p data-v-75e80776>この後論理ゲートを実装していきますが、結果が確認できないと困ります。予め最低限の出力処理を用意しておくことにします。レギュレーションより、ここでは自由な値の利用が許可されます。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>最低限の出力処理</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>using</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>O<span class="token punctuation" data-v-75e80776>;</span>
<span class="token keyword" data-v-75e80776>using</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>I<span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary T<span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>bitToChar</span> <span class="token punctuation" data-v-75e80776>{</span><span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero T<span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>bitToChar</span><span class="token operator" data-v-75e80776>&lt;</span>T<span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>inline</span> <span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>constexpr</span> <span class="token keyword" data-v-75e80776>const</span> <span class="token keyword" data-v-75e80776>char</span> v <span class="token operator" data-v-75e80776>=</span> <span class="token string" data-v-75e80776>'0'</span><span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne T<span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>bitToChar</span><span class="token operator" data-v-75e80776>&lt;</span>T<span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>inline</span> <span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>constexpr</span> <span class="token keyword" data-v-75e80776>const</span> <span class="token keyword" data-v-75e80776>char</span> v <span class="token operator" data-v-75e80776>=</span> <span class="token string" data-v-75e80776>'1'</span><span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary T<span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>constexpr</span> <span class="token keyword" data-v-75e80776>const</span> <span class="token keyword" data-v-75e80776>char</span> bitToCharV <span class="token operator" data-v-75e80776>=</span> bitToChar<span class="token operator" data-v-75e80776>&lt;</span>T<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>v<span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span><span class="token operator" data-v-75e80776>></span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>void</span> <span class="token function" data-v-75e80776>printTruthTable</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span> <span class="token punctuation" data-v-75e80776>{</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"0 0 | {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>Gate<span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"0 1 | {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>Gate<span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"1 0 | {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>Gate<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"1 1 | {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>Gate<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<p data-v-75e80776>このコードは、2入力1出力のゲート型を受け取って、その真理値表を出力するものです。基本論理ゲートの動作確認にはこれを使っていきます。</p>
<h1 id="基本論理ゲートを実装する" data-v-75e80776><a href="#%E5%9F%BA%E6%9C%AC%E8%AB%96%E7%90%86%E3%82%B2%E3%83%BC%E3%83%88%E3%82%92%E5%AE%9F%E8%A3%85%E3%81%99%E3%82%8B" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>基本論理ゲートを実装する</h1>
<p data-v-75e80776>前述の記事では、基本論理ゲートの出力をテーブル化して参照するようにしていました。しかし、<strong data-v-75e80776>NAND論理の完全性</strong>を利用すればNAND以外のゲートをテーブル化する必要はありませんので、本記事ではテーブル化するゲートはNANDのみとし、その他のゲートはNAND型を組み合わせた型として実装していきます。</p>
<h2 id="nandゲート型" data-v-75e80776><a href="#nand%E3%82%B2%E3%83%BC%E3%83%88%E5%9E%8B" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>NANDゲート型</h2>
<p data-v-75e80776>NANDゲートの実装は以下のようなものにしました。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>basic_gates.h(NAND部)</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776>    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span>  <span class="token punctuation" data-v-75e80776>{</span><span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>One<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>One<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>One<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>Zero<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NANDv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X
</code></pre></div>
<p data-v-75e80776>C++20のコンセプト万々歳です。とても楽にテンプレートパラメータに基づいたオーバーロードを書くことが出来ます。これで、NAND型のテンプレートパラメータとして渡された2つのバイナリ型の組み合わせによって、NAND型がその内部にNANDゲートの出力であるバイナリ型の型エイリアス<code data-v-75e80776>X</code>を持つようになります。</p>
<p data-v-75e80776>動作しているかどうか、先程用意した出力処理を利用して検証してみます。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>NAND出力テスト</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>int</span> <span class="token function" data-v-75e80776>main</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>NANDv<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<div class="nuxt-content-highlight" data-v-75e80776><pre class="line-numbers language-text" data-v-75e80776><code data-v-75e80776>0 0 | 1
0 1 | 1
1 0 | 1
1 1 | 0
</code></pre></div>
<p data-v-75e80776>どうやらしっかり動作しているようです！</p>
<h2 id="その他のゲートの型を用意する" data-v-75e80776><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%B2%E3%83%BC%E3%83%88%E3%81%AE%E5%9E%8B%E3%82%92%E7%94%A8%E6%84%8F%E3%81%99%E3%82%8B" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>その他のゲートの型を用意する</h2>
<p data-v-75e80776>先述したとおり、あらゆる論理ゲートはNANDゲートを用いて表現することが出来ます。つまりは、NAND型を組み合わせるだけで他のゲートの型は用意できるわけです。一気にやってしまいましょう。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>basic_gates.h(その他のゲート達)</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776>    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NOT <span class="token operator" data-v-75e80776>=</span> NAND<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> A<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NOTv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NOT</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> AND <span class="token operator" data-v-75e80776>=</span> NOT<span class="token operator" data-v-75e80776>&lt;</span>NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> ANDv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>AND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> OR <span class="token operator" data-v-75e80776>=</span> NAND<span class="token operator" data-v-75e80776>&lt;</span>NOTv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> NOTv<span class="token operator" data-v-75e80776>&lt;</span>B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> ORv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>OR</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NOR <span class="token operator" data-v-75e80776>=</span> NOT<span class="token operator" data-v-75e80776>&lt;</span>ORv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NORv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NOR</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> XOR <span class="token operator" data-v-75e80776>=</span> NAND<span class="token operator" data-v-75e80776>&lt;</span>NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>,</span> NANDv<span class="token operator" data-v-75e80776>&lt;</span>NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> XORv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>XOR</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X
</code></pre></div>
<p data-v-75e80776><code data-v-75e80776>NOT</code>/<code data-v-75e80776>AND</code>/<code data-v-75e80776>OR</code>/<code data-v-75e80776>NOR</code>/<code data-v-75e80776>XOR</code>の型を定義しました。すべてエイリアステンプレートのみによって実現することが出来ました。<code data-v-75e80776>NAND</code>に感謝です。</p>
<p data-v-75e80776>一応、出力を確認しておきましょう。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>出力テスト</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>int</span> <span class="token function" data-v-75e80776>main</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>ANDv<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"NAND"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>ORv<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"OR"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>NORv<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"NOR"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>XORv<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"XOR"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<div class="nuxt-content-highlight" data-v-75e80776><pre class="line-numbers language-text" data-v-75e80776><code data-v-75e80776>[NAND]
0 0 | 0
0 1 | 0
1 0 | 0
1 1 | 1
[OR]
0 0 | 0
0 1 | 1
1 0 | 1
1 1 | 1
[NOR]
0 0 | 1
0 1 | 0
1 0 | 0
1 1 | 0
[XOR]
0 0 | 0
0 1 | 1
1 0 | 1
1 1 | 0
</code></pre></div>
<p data-v-75e80776>完璧です。きちんと型のみで論理ゲートが実装できています。</p>
<h3 id="基本論理ゲートのソースコード" data-v-75e80776><a href="#%E5%9F%BA%E6%9C%AC%E8%AB%96%E7%90%86%E3%82%B2%E3%83%BC%E3%83%88%E3%81%AE%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>基本論理ゲートのソースコード</h3>
<p data-v-75e80776>基本論理ゲートの実装全体を以下に示しておきます。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>basic_gates.h</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>pragma</span> <span class="token expression" data-v-75e80776>once</span></span>

<span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>include</span> <span class="token string" data-v-75e80776>"binary.h"</span></span>

<span class="token keyword" data-v-75e80776>namespace</span> Gates <span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span>  <span class="token punctuation" data-v-75e80776>{</span><span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>I<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>I<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsZero B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>I<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsOne B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span>  <span class="token punctuation" data-v-75e80776>{</span> <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>O<span class="token punctuation" data-v-75e80776>;</span> <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NANDv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NAND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NOT <span class="token operator" data-v-75e80776>=</span> NAND<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> A<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NOTv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NOT</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> AND <span class="token operator" data-v-75e80776>=</span> NOT<span class="token operator" data-v-75e80776>&lt;</span>NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> ANDv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>AND</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> OR <span class="token operator" data-v-75e80776>=</span> NAND<span class="token operator" data-v-75e80776>&lt;</span>NOTv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> NOTv<span class="token operator" data-v-75e80776>&lt;</span>B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> ORv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>OR</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NOR <span class="token operator" data-v-75e80776>=</span> NOT<span class="token operator" data-v-75e80776>&lt;</span>ORv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NORv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NOR</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> XOR <span class="token operator" data-v-75e80776>=</span> NAND<span class="token operator" data-v-75e80776>&lt;</span>NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>,</span> NANDv<span class="token operator" data-v-75e80776>&lt;</span>NANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> XORv <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>XOR</span><span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<p data-v-75e80776>ここまでくれば加算器なんて簡単です。</p>
<h1 id="加算器" data-v-75e80776><a href="#%E5%8A%A0%E7%AE%97%E5%99%A8" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>加算器</h1>
<p data-v-75e80776>型で加算器を実装していきます。</p>
<h2 id="半加算器" data-v-75e80776><a href="#%E5%8D%8A%E5%8A%A0%E7%AE%97%E5%99%A8" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>半加算器</h2>
<p data-v-75e80776>全加算器を作るためには、まず半加算器からです。
<img alt="image.png" src="/article-assets/cpp/write-an-nbit-adder-using-only-types/half-adder.png" data-v-75e80776>
半加算器は出力が複数あるため、これまでのように基本論理ゲートのエイリアステンプレートで定義することは出来ません。構造体を使って独自の型として実現していきましょう。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>basic_adders.h(HalfAdder部)</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776>    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>HalfAdder</span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>XORv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> Y <span class="token operator" data-v-75e80776>=</span> Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>ANDv<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
</code></pre></div>
<p data-v-75e80776>以上です。なんと容易いのでしょうか。<code data-v-75e80776>XOR</code>が既に存在するおかげで、半加算器はたったこれだけのコードで実現できました。動作を確認します。出力が増えたため、新たな出力関数を定義しています。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>出力テスト</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span><span class="token operator" data-v-75e80776>></span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>void</span> <span class="token function" data-v-75e80776>printTruthTable2_2</span><span class="token punctuation" data-v-75e80776>(</span><span class="token keyword" data-v-75e80776>const</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>string<span class="token operator" data-v-75e80776>&</span> title<span class="token punctuation" data-v-75e80776>)</span> <span class="token punctuation" data-v-75e80776>{</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"[{}]\n"</span><span class="token punctuation" data-v-75e80776>,</span> title<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"A B | Y X\n"</span><span class="token punctuation" data-v-75e80776>,</span> title<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"0 0 | {} {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"0 1 | {} {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"1 0 | {} {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"1 1 | {} {}\n"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>

<span class="token keyword" data-v-75e80776>int</span> <span class="token function" data-v-75e80776>main</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable2_2</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>HalfAdder<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"HalfAdder"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<div class="nuxt-content-highlight" data-v-75e80776><pre class="line-numbers language-text" data-v-75e80776><code data-v-75e80776>[HalfAdder]
A B | Y X
0 0 | 0 0
0 1 | 0 1
1 0 | 0 1
1 1 | 1 0
</code></pre></div>
<p data-v-75e80776>きちんと加算できていますし、桁上りの出力も正常です。半加算器型が実現できています。</p>
<h2 id="全加算器" data-v-75e80776><a href="#%E5%85%A8%E5%8A%A0%E7%AE%97%E5%99%A8" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>全加算器</h2>
<p data-v-75e80776><img alt="image.png" src="/article-assets/cpp/write-an-nbit-adder-using-only-types/full-adder.png" data-v-75e80776>
半加算器と全く同じです。違いを上げるとすれば、可読性のために構造体内部で型エイリアスを利用しているくらいです。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>basic_adders.h(FullAdder部)</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776>    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary A<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary B<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary C<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>class</span> <span class="token class-name" data-v-75e80776>FullAdder</span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>using</span> HA1 <span class="token operator" data-v-75e80776>=</span> HalfAdder<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> HA2 <span class="token operator" data-v-75e80776>=</span> HalfAdder<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>HA1</span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>,</span> C<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>public</span><span class="token operator" data-v-75e80776>:</span>
        <span class="token keyword" data-v-75e80776>using</span> X <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>HA2</span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> Y <span class="token operator" data-v-75e80776>=</span> Gates<span class="token double-colon punctuation" data-v-75e80776>::</span>ORv<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>HA1</span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>HA2</span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
</code></pre></div>
<p data-v-75e80776>早速出力を見てみましょう。今度は入力が増えたので、再び新たな出力関数を定義しています。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>出力テスト</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span><span class="token operator" data-v-75e80776>></span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>void</span> <span class="token function" data-v-75e80776>printTruthTable3_2</span><span class="token punctuation" data-v-75e80776>(</span><span class="token keyword" data-v-75e80776>const</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>string<span class="token operator" data-v-75e80776>&</span> title<span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"[{}]\n"</span><span class="token punctuation" data-v-75e80776>,</span> title<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"A B C | Y X\n"</span>
               <span class="token string" data-v-75e80776>"0 0 0 | {} {}\n0 0 1 | {} {}\n0 1 0 | {} {}\n0 1 1 | {} {}\n"</span>
               <span class="token string" data-v-75e80776>"1 0 0 | {} {}\n1 0 1 | {} {}\n1 1 0 | {} {}\n1 1 1 | {} {}\n"</span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
            bitToCharV<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Gate</span><span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token operator" data-v-75e80776>></span>
            <span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>

<span class="token keyword" data-v-75e80776>int</span> <span class="token function" data-v-75e80776>main</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    <span class="token generic-function" data-v-75e80776><span class="token function" data-v-75e80776>printTruthTable3_2</span><span class="token generic class-name" data-v-75e80776><span class="token operator" data-v-75e80776>&lt;</span>Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>FullAdder<span class="token operator" data-v-75e80776>></span></span></span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"FullAdder"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<div class="nuxt-content-highlight" data-v-75e80776><pre class="line-numbers language-text" data-v-75e80776><code data-v-75e80776>[FullAdder]
A B C | Y X
0 0 0 | 0 0
0 0 1 | 0 1
0 1 0 | 0 1
0 1 1 | 1 0
1 0 0 | 0 1
1 0 1 | 1 0
1 1 0 | 1 0
1 1 1 | 1 1
</code></pre></div>
<p data-v-75e80776>はい。完璧です。</p>
<h2 id="n-bit加算器" data-v-75e80776><a href="#n-bit%E5%8A%A0%E7%AE%97%E5%99%A8" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>N bit加算器</h2>
<p data-v-75e80776><img alt="image.png" src="/article-assets/cpp/write-an-nbit-adder-using-only-types/nbit-adder.png" data-v-75e80776>
さて、全加算器が出来ましたので、複数bitの加算がしたくなってきます。4 bitなどの固定長としても良いですが、我々が今利用しているのはソフトウェアですので、ビット長くらいパラメトリックにしたいものです。C++には可変長テンプレートというN bit加算器のための機能がありますので、こちらを利用して実装してみます。</p>
<h3 id="バイナリ型シーケンスの作成" data-v-75e80776><a href="#%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E5%9E%8B%E3%82%B7%E3%83%BC%E3%82%B1%E3%83%B3%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>バイナリ型シーケンスの作成</h3>
<p data-v-75e80776>N bitの加算器を作成するにあたっては、その加算対象となる値や得られる結果をバイナリ型のシーケンスとして扱いたくなります。型のシーケンスなんて作れるのかと思うかもしれませんが、それほど難しくありません。以下を<code data-v-75e80776>binary.h</code>に追記します。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>binary.h</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776>    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>T</span><span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>IType</span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>using</span> type <span class="token operator" data-v-75e80776>=</span> T<span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Bs<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>BinarySeq</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span><span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>IndexSeq</span><span class="token punctuation" data-v-75e80776>,</span> IsBinary SetType<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t Pos<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t Len<span class="token punctuation" data-v-75e80776>,</span> IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Ts<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>BinarySeqSetHelper</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span><span class="token operator" data-v-75e80776>&lt;</span>std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Indexes<span class="token punctuation" data-v-75e80776>,</span> IsBinary SetType<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t Pos<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t Len<span class="token punctuation" data-v-75e80776>,</span> IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Ts<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>BinarySeqSetHelper</span><span class="token operator" data-v-75e80776>&lt;</span>std<span class="token double-colon punctuation" data-v-75e80776>::</span>index_sequence<span class="token operator" data-v-75e80776>&lt;</span>Indexes<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> SetType<span class="token punctuation" data-v-75e80776>,</span> Pos<span class="token punctuation" data-v-75e80776>,</span> Len<span class="token punctuation" data-v-75e80776>,</span> Ts<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span>
      <span class="token operator" data-v-75e80776>:</span> IType<span class="token operator" data-v-75e80776>&lt;</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>
            std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple_element_t<span class="token operator" data-v-75e80776>&lt;</span>Indexes <span class="token operator" data-v-75e80776>==</span> Pos <span class="token operator" data-v-75e80776>?</span> Len <span class="token operator" data-v-75e80776>:</span> Indexes<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple<span class="token operator" data-v-75e80776>&lt;</span>Ts<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>,</span> SetType<span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>static_assert</span><span class="token punctuation" data-v-75e80776>(</span>Pos <span class="token operator" data-v-75e80776>&lt;</span> Len<span class="token punctuation" data-v-75e80776>,</span> <span class="token string" data-v-75e80776>"out of range"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span><span class="token operator" data-v-75e80776>&lt;</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Bs<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>BinarySeq</span> <span class="token operator" data-v-75e80776>:</span> <span class="token base-clause" data-v-75e80776><span class="token class-name" data-v-75e80776>IType</span><span class="token operator" data-v-75e80776>&lt;</span><span class="token class-name" data-v-75e80776>BinarySeq</span><span class="token operator" data-v-75e80776>&lt;</span><span class="token class-name" data-v-75e80776>Bs</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span></span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>constexpr</span> <span class="token keyword" data-v-75e80776>const</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t size <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>Bs<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>

        <span class="token keyword" data-v-75e80776>template</span><span class="token operator" data-v-75e80776>&lt;</span>IsBinary SetType<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t Pos<span class="token operator" data-v-75e80776>></span>
        <span class="token keyword" data-v-75e80776>using</span> Set <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>BinarySeqSetHelper</span><span class="token operator" data-v-75e80776>&lt;</span>std<span class="token double-colon punctuation" data-v-75e80776>::</span>make_index_sequence<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>Bs<span class="token punctuation" data-v-75e80776>)</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span>
                                 SetType<span class="token punctuation" data-v-75e80776>,</span>
                                 Pos<span class="token punctuation" data-v-75e80776>,</span>
                                 <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>Bs<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span>
                                 Bs<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>type<span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span><span class="token operator" data-v-75e80776>&lt;</span>IsBinary B<span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t N<span class="token punctuation" data-v-75e80776>,</span> IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Bs<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>GenBinarySeq</span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>using</span> type <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>GenBinarySeq</span><span class="token operator" data-v-75e80776>&lt;</span>B<span class="token punctuation" data-v-75e80776>,</span> N <span class="token operator" data-v-75e80776>-</span> <span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> Bs<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>type<span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span><span class="token operator" data-v-75e80776>&lt;</span>IsBinary B<span class="token punctuation" data-v-75e80776>,</span> IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> Bs<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>GenBinarySeq</span><span class="token operator" data-v-75e80776>&lt;</span>B<span class="token punctuation" data-v-75e80776>,</span> <span class="token number" data-v-75e80776>0</span><span class="token punctuation" data-v-75e80776>,</span> Bs<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>using</span> type <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>IType</span><span class="token operator" data-v-75e80776>&lt;</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>Bs<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>type<span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
</code></pre></div>
<p data-v-75e80776>ここでは、<code data-v-75e80776>BinarySeq</code>という可変長テンプレートパラメータにIsBinaryを満たすバイナリ型を持つ型を定義しています。<code data-v-75e80776>BinarySeq</code>が持つ型パラメータを型シーケンスと見做すわけです。<code data-v-75e80776>BinarySeq</code>には<code data-v-75e80776>Set</code>という型エイリアステンプレートが含まれていますが、この<code data-v-75e80776>Set</code>はテンプレートパラメータとしてシーケンス上の位置と書き込みたい型を指定すると、そのように編集した後の型シーケンスを表すようになるという機能を持っています。また、<code data-v-75e80776>GenBinarySeq</code>という型も定義されています。これは、テンプレートパラメータとして型と長さを指定すると、指定された型と長さを持つ<code data-v-75e80776>BinarySeq</code>を作成してくれます。</p>
<h4 id="binaryseqを出力可能にする" data-v-75e80776><a href="#binaryseq%E3%82%92%E5%87%BA%E5%8A%9B%E5%8F%AF%E8%83%BD%E3%81%AB%E3%81%99%E3%82%8B" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a><code data-v-75e80776>BinarySeq</code>を出力可能にする</h4>
<p data-v-75e80776>バイナリ型を任意の長さのシーケンスとして保持できるようになったのは良いですが、これは値ではなく型テンプレートパラメータとして保持されているに過ぎません。これを我々の確認できる形で出力することは、以下のような実装で実現することが出来ます。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>BinarySeqの出力実装</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Bs</span><span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S<span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span> <span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>void</span> <span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token punctuation" data-v-75e80776>(</span>fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"{}"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>S<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span>
<span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
</code></pre></div>
<p data-v-75e80776>テンプレートの部分特殊化を利用して、<code data-v-75e80776>BinarySeq</code>の型パラメータ部分だけを取り出し、c++17で導入されたfold expressionで出力しています。</p>
<h4 id="binaryseqを使ってみる" data-v-75e80776><a href="#binaryseq%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a><code data-v-75e80776>BinarySeq</code>を使ってみる</h4>
<p data-v-75e80776>言葉で言われてもわかりにくいかと思いますので、実際の<code data-v-75e80776>BinarySeq</code>の動作を示すサンプルを提示します。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>BinarySeqのサンプルコード</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>int</span> <span class="token function" data-v-75e80776>main</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>using</span> Seq1 <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"1: "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Seq1<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"\n"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>using</span> Seq2 <span class="token operator" data-v-75e80776>=</span> Seq1<span class="token double-colon punctuation" data-v-75e80776>::</span>Set<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> <span class="token number" data-v-75e80776>4</span><span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Set<span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> <span class="token number" data-v-75e80776>1</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"2: "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Seq2<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"\n"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>using</span> Seq3 <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>GenBinarySeq<span class="token operator" data-v-75e80776>&lt;</span>O<span class="token punctuation" data-v-75e80776>,</span> <span class="token number" data-v-75e80776>4</span><span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>type<span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"3: "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Seq3<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"\n"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>using</span> Seq4 <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>GenBinarySeq<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> <span class="token number" data-v-75e80776>5</span><span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>type<span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"4: "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Seq4<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"\n"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>using</span> Seq5 <span class="token operator" data-v-75e80776>=</span> Seq3<span class="token double-colon punctuation" data-v-75e80776>::</span>Set<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> <span class="token number" data-v-75e80776>2</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"5: "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token class-name" data-v-75e80776>BinarySeqPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Seq5<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"\n"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<div class="nuxt-content-highlight" data-v-75e80776><pre class="line-numbers language-text" data-v-75e80776><code data-v-75e80776>1: 11100101
2: 10101101
3: 0000
4: 11111
5: 0010
</code></pre></div>
<p data-v-75e80776>完全に型テンプレートパラメータが「任意長で扱えて」、「要素の編集も可能」なリストと化しています。きっとそういう機能なんだと思います(？)。</p>
<h3 id="n-bit加算器本体" data-v-75e80776><a href="#n-bit%E5%8A%A0%E7%AE%97%E5%99%A8%E6%9C%AC%E4%BD%93" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>N bit加算器本体</h3>
<p data-v-75e80776>ここまでで、すべての準備は整いました。あとはこれらを利用してN bit加算器を実装するだけです。もったいぶっても仕方ないので(小出しにして詳細に説明するのが面倒なので)実装を貼ります。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>n_bit_adder.h</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>pragma</span> <span class="token expression" data-v-75e80776>once</span></span>

<span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>include</span> <span class="token string" data-v-75e80776>&lt;tuple></span></span>
<span class="token macro property" data-v-75e80776><span class="token directive-hash" data-v-75e80776>#</span><span class="token directive keyword" data-v-75e80776>include</span> <span class="token string" data-v-75e80776>"basic_adders.h"</span></span>

<span class="token keyword" data-v-75e80776>namespace</span> Circuits <span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t Len<span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>BS1</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>BS2</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>BS3</span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary Ci<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NbitAdderHelper</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S1<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S2<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S3<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary Ci<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NbitAdderHelper</span><span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S3<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Ci<span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>static_assert</span><span class="token punctuation" data-v-75e80776>(</span><span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>==</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S2<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>&&</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>==</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S3<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token string" data-v-75e80776>"Bit length not matched."</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>constexpr</span> <span class="token keyword" data-v-75e80776>const</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t N <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> A <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple_element_t<span class="token operator" data-v-75e80776>&lt;</span>N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> B <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple_element_t<span class="token operator" data-v-75e80776>&lt;</span>N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> HAdder <span class="token operator" data-v-75e80776>=</span> Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>HalfAdder<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>

        <span class="token keyword" data-v-75e80776>using</span> Ss <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NbitAdderHelper</span><span class="token operator" data-v-75e80776>&lt;</span>N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Binary</span><span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S3<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token keyword" data-v-75e80776>template</span> Set<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>HAdder</span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>,</span> N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>HAdder</span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Ss<span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>std<span class="token double-colon punctuation" data-v-75e80776>::</span>size_t N<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S1<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S2<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S3<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary Ci<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NbitAdderHelper</span><span class="token operator" data-v-75e80776>&lt;</span>N<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S3<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Ci<span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>static_assert</span><span class="token punctuation" data-v-75e80776>(</span><span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>==</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S2<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>&&</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>==</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S3<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token string" data-v-75e80776>"Bit length not matched."</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> A <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple_element_t<span class="token operator" data-v-75e80776>&lt;</span>N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> B <span class="token operator" data-v-75e80776>=</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple_element_t<span class="token operator" data-v-75e80776>&lt;</span>N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> std<span class="token double-colon punctuation" data-v-75e80776>::</span>tuple<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> FAdder <span class="token operator" data-v-75e80776>=</span> Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>FullAdder<span class="token operator" data-v-75e80776>&lt;</span>A<span class="token punctuation" data-v-75e80776>,</span> B<span class="token punctuation" data-v-75e80776>,</span> Ci<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>

        <span class="token keyword" data-v-75e80776>using</span> Ss <span class="token operator" data-v-75e80776>=</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>NbitAdderHelper</span><span class="token operator" data-v-75e80776>&lt;</span>N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Binary</span><span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S3<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token keyword" data-v-75e80776>template</span> Set<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>FAdder</span><span class="token double-colon punctuation" data-v-75e80776>::</span>X<span class="token punctuation" data-v-75e80776>,</span> N<span class="token operator" data-v-75e80776>-</span><span class="token number" data-v-75e80776>1</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>FAdder</span><span class="token double-colon punctuation" data-v-75e80776>::</span>Y<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>Ss<span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S1<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S2<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S3<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary Ci<span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NbitAdderHelper</span><span class="token operator" data-v-75e80776>&lt;</span><span class="token number" data-v-75e80776>0</span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S3<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Ci<span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token keyword" data-v-75e80776>static_assert</span><span class="token punctuation" data-v-75e80776>(</span><span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>==</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S2<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>&&</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S1<span class="token punctuation" data-v-75e80776>)</span> <span class="token operator" data-v-75e80776>==</span> <span class="token keyword" data-v-75e80776>sizeof</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>(</span>S3<span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token string" data-v-75e80776>"Bit length not matched."</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token keyword" data-v-75e80776>using</span> Ss <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>Ci<span class="token punctuation" data-v-75e80776>,</span> S3<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>

    <span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>BS1</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>BS2</span><span class="token operator" data-v-75e80776>></span>
    <span class="token keyword" data-v-75e80776>using</span> NbitAdder <span class="token operator" data-v-75e80776>=</span> NbitAdderHelper<span class="token operator" data-v-75e80776>&lt;</span>BS1<span class="token double-colon punctuation" data-v-75e80776>::</span>size<span class="token punctuation" data-v-75e80776>,</span> BS1<span class="token punctuation" data-v-75e80776>,</span> BS2<span class="token punctuation" data-v-75e80776>,</span> <span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Binary</span><span class="token double-colon punctuation" data-v-75e80776>::</span>GenBinarySeq<span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>O<span class="token punctuation" data-v-75e80776>,</span> BS1<span class="token double-colon punctuation" data-v-75e80776>::</span>size<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span>type<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>O<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<p data-v-75e80776>いや～C++は良い言語ですね！！！！
このコードでやっているのは、先に示した回路図の安直な再現です。「一番はじめの半加算器」「2番目～から[ビット長-1]番目の全加算器」「終了処理」の3つに特殊化されるように実装を切り分け、再帰的に演算結果を伝達させていっています。テンプレートパラメータの名前で説明するのならば、「<code data-v-75e80776>std::size_t N</code>がその時に対象としている半加算器/全加算器の通番」「<code data-v-75e80776>typename BS1</code>と<code data-v-75e80776>typename BS2</code>は加算に使われる2つのバイナリ型シーケンス」「<code data-v-75e80776>typename BS3</code>は演算結果を保持しているバイナリ型シーケンス」「<code data-v-75e80776>Binary::IsBinary Ci</code>は下位の加算器からの桁上り入力」です。結果として、演算対象とするシーケンスを受け取った<code data-v-75e80776>NbitAdderHelper</code>型は「先頭に最後の桁上り、2番めから終端までが演算結果」となるバイナリ型シーケンスを示す型<code data-v-75e80776>Ss</code>を内部に持つようになります。読みにくさはピカイチですが、やっていることはそんなに複雑ではありません。</p>
<p data-v-75e80776>この実装では与えられる<code data-v-75e80776>BinarySeq</code>の長さが同一でなければ静的アサートでコンパイルエラーとなるようにしています。しかし、今回の処理は加算であるため、単純な0埋めの(メタ)実装を追加することで異なる長さの<code data-v-75e80776>BinarySeq</code>も加算可能になります(あれ、でもそれって加算回路的にどうなの)。</p>
<p data-v-75e80776>ここで例によって、結果を見える形にするための出力処理を実装しておきます。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>NbitAdderprintHelper</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Bs</span><span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NbitAdderPrintHelper</span><span class="token punctuation" data-v-75e80776>;</span>

<span class="token keyword" data-v-75e80776>template</span> <span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S1<span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>IsBinary<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span> S2<span class="token operator" data-v-75e80776>></span>
<span class="token keyword" data-v-75e80776>struct</span> <span class="token class-name" data-v-75e80776>NbitAdderPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>NbitAdder<span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token operator" data-v-75e80776>></span> <span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>static</span> <span class="token keyword" data-v-75e80776>void</span> <span class="token function" data-v-75e80776>print_result</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span> <span class="token punctuation" data-v-75e80776>{</span>
        <span class="token punctuation" data-v-75e80776>(</span>fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"{}"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>" + "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        <span class="token punctuation" data-v-75e80776>(</span>fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"{}"</span><span class="token punctuation" data-v-75e80776>,</span> bitToCharV<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>,</span> <span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>

        <span class="token keyword" data-v-75e80776>using</span> Adder <span class="token operator" data-v-75e80776>=</span> Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>NbitAdder<span class="token operator" data-v-75e80776>&lt;</span>Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S1<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>,</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>S2<span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token punctuation" data-v-75e80776>.</span><span class="token operator" data-v-75e80776>>></span><span class="token punctuation" data-v-75e80776>;</span>
        fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>" = "</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        BinarySeqPrintHelper<span class="token operator" data-v-75e80776>&lt;</span><span class="token keyword" data-v-75e80776>typename</span> <span class="token class-name" data-v-75e80776>Adder</span><span class="token double-colon punctuation" data-v-75e80776>::</span>Ss<span class="token operator" data-v-75e80776>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
        fmt<span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print</span><span class="token punctuation" data-v-75e80776>(</span><span class="token string" data-v-75e80776>"\n"</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token punctuation" data-v-75e80776>}</span>
<span class="token punctuation" data-v-75e80776>}</span><span class="token punctuation" data-v-75e80776>;</span>
</code></pre></div>
<p data-v-75e80776>特筆すべきところは特にありませんね。では結果を確認していきましょう！</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>Nbit加算器動作確認</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token keyword" data-v-75e80776>int</span> <span class="token function" data-v-75e80776>main</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span>
<span class="token punctuation" data-v-75e80776>{</span>
    <span class="token keyword" data-v-75e80776>using</span> ASeq <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token keyword" data-v-75e80776>using</span> BSeq <span class="token operator" data-v-75e80776>=</span> Binary<span class="token double-colon punctuation" data-v-75e80776>::</span>BinarySeq<span class="token operator" data-v-75e80776>&lt;</span>I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> O<span class="token punctuation" data-v-75e80776>,</span> I<span class="token punctuation" data-v-75e80776>,</span> I<span class="token operator" data-v-75e80776>></span><span class="token punctuation" data-v-75e80776>;</span>
    <span class="token class-name" data-v-75e80776>NbitAdderPrintHelper</span><span class="token operator" data-v-75e80776>&lt;</span>Circuits<span class="token double-colon punctuation" data-v-75e80776>::</span>NbitAdder<span class="token operator" data-v-75e80776>&lt;</span>ASeq<span class="token punctuation" data-v-75e80776>,</span> BSeq<span class="token operator" data-v-75e80776>>></span><span class="token double-colon punctuation" data-v-75e80776>::</span><span class="token function" data-v-75e80776>print_result</span><span class="token punctuation" data-v-75e80776>(</span><span class="token punctuation" data-v-75e80776>)</span><span class="token punctuation" data-v-75e80776>;</span>
<span class="token punctuation" data-v-75e80776>}</span>
</code></pre></div>
<div class="nuxt-content-highlight" data-v-75e80776><pre class="line-numbers language-text" data-v-75e80776><code data-v-75e80776>1110010100110110 + 1101001101000011 = 11011100001111001
</code></pre></div>
<p data-v-75e80776>この結果が正しいのか、Windowsの電卓くんに計算してもらいました。
<img alt="出力検証結果" src="/article-assets/cpp/write-an-nbit-adder-using-only-types/result.png" data-v-75e80776></p>
<p data-v-75e80776>やった！完璧ですね！！C++の型システム上でN bitの加算器を動作させることに成功しました！！</p>
<h1 id="おわりに" data-v-75e80776><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>おわりに</h1>
<p data-v-75e80776>ここまで記事を読んでくださった方に朗報があります。C++には**+演算子**と呼ばれる演算子が存在しており、以下のように記述することで加算を行うことが出来ます。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>add</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token number" data-v-75e80776>1</span> <span class="token operator" data-v-75e80776>+</span> <span class="token number" data-v-75e80776>2</span> <span class="token comment" data-v-75e80776>// → 3</span>
</code></pre></div>
<p data-v-75e80776>また、このようにコンパイル時に値が確定するリテラルとして表記された値は、コンパイラの最適化によってコンパイル時に演算結果の値へと置き換えられることが殆どであり、実行時コストを考える必要もありません。2進数以外読めないという方も安心してください。C++14からのC++は2進数リテラルを持っています。</p>
<div class="nuxt-content-highlight" data-v-75e80776><span class="filename" data-v-75e80776>bin_add</span><pre class="line-numbers language-cpp" data-v-75e80776><code data-v-75e80776><span class="token number" data-v-75e80776>0b1</span> <span class="token operator" data-v-75e80776>+</span> <span class="token number" data-v-75e80776>0b10</span> <span class="token comment" data-v-75e80776>// → 0b11 (3)</span>
</code></pre></div>
<p data-v-75e80776>よって、C++の型システムで加算器を実装する必要はありません。</p>
<h1 id="追記" data-v-75e80776><a href="#%E8%BF%BD%E8%A8%98" aria-hidden="true" tabindex="-1" data-v-75e80776><span class="icon icon-link" data-v-75e80776></span></a>追記</h1>
<p data-v-75e80776>本記事で利用したソースコードをGitHubにあげておきました。
<a href="https://github.com/strvworks/logical_cpp/tree/master" rel="nofollow noopener noreferrer" target="_blank" data-v-75e80776>https://github.com/strvworks/logical_cpp/tree/master</a></p></div></div></article> <div class="surround-menu" data-v-75e80776><section data-fetch-key="data-v-08b63208:0" class="wrapper" data-v-08b63208 data-v-75e80776><div class="prev button" data-v-08b63208><!----></div> <div class="seriesname button" data-v-08b63208><a href="/blog/series/undefined" data-v-08b63208>
      
    </a></div> <div class="next button" data-v-08b63208><!----></div></section></div> <article class="giscus-wrapper" data-v-75e80776><div data-v-75e80776><div class="giscus"></div></div></article></div></div></div></div></main> <div class="footer-wrapper" data-v-30c6efbe data-v-5d1ecaf6><footer class="footer-main" data-v-30c6efbe><div class="links" data-v-30c6efbe><address data-v-30c6efbe><p data-v-30c6efbe><i class="im im-github" data-v-30c6efbe></i> <a href="https://github.com/strvert" data-v-30c6efbe>strvert</a></p> <p data-v-30c6efbe><i class="im im-twitter" data-v-30c6efbe></i> <a href="https://twitter.com/strvert" data-v-30c6efbe>@strvert</a></p> <p data-v-30c6efbe><i class="im im-book" data-v-30c6efbe></i> <a href="https://github.com/strvert/strv.dev" data-v-30c6efbe>strvert/strv.dev</a></p></address></div> <div class="infos" data-v-30c6efbe><p data-v-30c6efbe><span class="copyright" data-v-30c6efbe>© 2021 stonriver (Riku Ishikawa).</span></p></div></footer></div></div></div></div><script defer src="/_nuxt/static/1638050348/blog/cpp--write-an-nbit-adder-using-only-types/state.js"></script><script src="/_nuxt/runtime.67a9642.js" defer></script><script src="/_nuxt/pages/blog/_blogpost.0d669ab.js" defer></script><script src="/_nuxt/pages/about/index/pages/blog/_blogpost.6ec5ae4.js" defer></script><script src="/_nuxt/commons/app.4008772.js" defer></script><script src="/_nuxt/vendors/app.0c1ae1a.js" defer></script><script src="/_nuxt/app.94d2496.js" defer></script>
  </body>
</html>
